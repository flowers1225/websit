xml2json={parser:function(a,b,c){var d,e,f;for(b||(b=""),a=a.replace(/\s*\/>/g,"/>"),a=a.replace(/<\?[^>]*>/g,"").replace(/<\![^>]*>/g,""),b.sort||(b=b.split(",")),d=this.no_fast_endings(a),d=this.attris_to_tags(d),d=escape(d),d=d.split("%3C").join("<").split("%3E").join(">").split("%3D").join("=").split("%22").join('"'),e=0;e<b.length;e++)d=d.replace(new RegExp("<"+b[e]+">","g"),"*$**"+b[e]+"**$*"),d=d.replace(new RegExp("</"+b[e]+">","g"),"*$***"+b[e]+"**$*");return d="<JSONTAGWRAPPER>"+d+"</JSONTAGWRAPPER>",this.xmlobject={},f=this.xml_to_object(d).jsontagwrapper,c&&(f=this.show_json_structure(f,c)),f},xml_to_object:function(xmlcode){var y,level,opentags,i,tagname,oldniva,objname,preeval,niva,tagnamn,rest,tabort,j,pobject,objlast,already,onlywhites,s,before,toeval,x=xmlcode.replace(/<\//g,"�");for(x=x.split("<"),y=[],level=0,opentags=[],i=1;i<x.length;i++)for(tagname=x[i].split(">")[0],opentags.push(tagname),level++,y.push(level+"<"+x[i].split("�")[0]);x[i].indexOf("�"+opentags[opentags.length-1]+">")>=0;)level--,opentags.pop();for(oldniva=-1,objname="this.xmlobject",i=0;i<y.length;i++){if(preeval="",niva=y[i].split("<")[0],tagnamn=y[i].split("<")[1].split(">")[0],tagnamn=tagnamn.toLowerCase(),rest=y[i].split(">")[1],oldniva>=niva)for(tabort=oldniva-niva+1,j=0;tabort>j;j++)objname=objname.substring(0,objname.lastIndexOf("."));objname+="."+tagnamn,pobject=objname.substring(0,objname.lastIndexOf(".")),"object"!=eval("typeof "+pobject)&&(preeval+=pobject+"={value:"+pobject+"};\n"),objlast=objname.substring(objname.lastIndexOf(".")+1),already=!1;for(k in eval(pobject))k==objlast&&(already=!0);for(onlywhites=!0,s=0;s<rest.length;s+=3)"%"!=rest.charAt(s)&&(onlywhites=!1);""==rest||onlywhites?rest="{}":rest/1!=rest&&(rest="'"+rest.replace(/\'/g,"\\'")+"'",rest=rest.replace(/\*\$\*\*\*/g,"</"),rest=rest.replace(/\*\$\*\*/g,"<"),rest=rest.replace(/\*\*\$\*/g,">")),"'"==rest.charAt(0)&&(rest="unescape("+rest+")"),already&&!eval(objname+".sort")&&(preeval+=objname+"=["+objname+"];\n"),before="=",after="",already&&(before=".push(",after=")"),toeval=preeval+objname+before+rest+after,eval(toeval),eval(objname+".sort")&&(objname+="["+eval(objname+".length-1")+"]"),oldniva=niva}return this.xmlobject},show_json_structure:function(a,b,c){var e,f,g,h,i,d="";d+=a.sort?"[\n":"{\n";for(e in a)a.sort||(d+=e+":"),"object"==typeof a[e]?d+=this.show_json_structure(a[e],!1,1):"function"==typeof a[e]?(f=a[e]+"",d+=f):d+="string"!=typeof a[e]?a[e]+",\n":"'"+a[e].replace(/\'/g,"\\'").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r")+"',\n";if(d+=a.sort?"],\n":"},\n",!c){for(d=d.substring(0,d.lastIndexOf(",")),d=d.replace(new RegExp(",\n}","g"),"\n}"),d=d.replace(new RegExp(",\n]","g"),"\n]"),g=d.split("\n"),d="",h=0,e=0;e<g.length;e++){for((g[e].indexOf("}")>=0||g[e].indexOf("]")>=0)&&h--,tabs="",i=0;h>i;i++)tabs+="	";d+=tabs+g[e]+"\n",(g[e].indexOf("{")>=0||g[e].indexOf("[")>=0)&&h++}"html"==b&&(d=d.replace(/</g,"&lt;").replace(/>/g,"&gt;"),d=d.replace(/\n/g,"<BR>").replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;")),"compact"==b&&(d=d.replace(/\n/g,"").replace(/\t/g,""))}return d},no_fast_endings:function(a){var b,c;for(a=a.split("/>"),b=1;b<a.length;b++)c=a[b-1].substring(a[b-1].lastIndexOf("<")+1).split(" ")[0],a[b]="></"+c+">"+a[b];return a=a.join("")},attris_to_tags:function(a){var c,d,e,f,b=" =\"'".split("");for(a=a.split(">"),c=0;c<a.length;c++){for(d=a[c].split("<"),e=0;4>e;e++)d[0]=d[0].replace(new RegExp(b[e],"g"),"_jsonconvtemp"+e+"_");if(d[1]){for(d[1]=d[1].replace(/'/g,'"'),d[1]=d[1].split('"'),f=1;f<d[1].length;f+=2)for(e=0;4>e;e++)d[1][f]=d[1][f].replace(new RegExp(b[e],"g"),"_jsonconvtemp"+e+"_");d[1]=d[1].join('"')}a[c]=d.join("<")}for(a=a.join(">"),a=a.replace(/ ([^=]*)=([^ |>]*)/g,"><$1>$2</$1"),a=a.replace(/>"/g,">").replace(/"</g,"<"),e=0;4>e;e++)a=a.replace(new RegExp("_jsonconvtemp"+e+"_","g"),b[e]);return a}},Array.prototype.push||(Array.prototype.push=function(a){return this[this.length]=a,!0}),Array.prototype.pop||(Array.prototype.pop=function(){var a=this[this.length-1];return this.length--,a});